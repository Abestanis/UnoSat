// *** AUTOGENERATED FILE - Do not edit manually! - Changes will be overwritten! *** //

#include "generated/checksum.h"

/** The polynomial to use for the crc calculation in nominal form. */
#define POLYNOMIAL 0x8811U

WEAK uint16_t calculateChecksumFromBuffer(BufferAccessor* buffer, size_t size, size_t at) {
    uint16_t crc = 0xFFFFU;
    for (size_t i = 0; i < size; i++) {
        uint8_t byte = 0;
        buffer->peek(buffer, &byte, sizeof(byte), at + i);
        crc ^= byte << 8U;
        for (uint8_t j = 0; j < 8U; j++) {
            if ((crc & 0x8000U) > 0U) {
                crc = (crc << 1U) ^ POLYNOMIAL;
            } else {
                crc <<= 1U;
            }
        }
    }
    return crc;
}

WEAK uint16_t calculateChecksum(const void* data, size_t size) {
    CONSTRUCT_SIMPLE_ACCESSOR_FROM_BUFFER(buffer, data, size);
    return calculateChecksumFromBuffer(&buffer, size, 0);
}
